# CLI æ¥å£å¥‘çº¦: Agent ä¼šè¯ç›‘æ§

**ç‰¹æ€§åˆ†æ”¯**: `010-agent-session-monitor`
**æ—¥æœŸ**: 2025-12-05

## 1. å‘½ä»¤æ¦‚è§ˆ

### 1.1 ç°æœ‰å‘½ä»¤å¢å¼º

#### `frago agent <prompt>`

**å˜æ›´**: å¢åŠ å®æ—¶çŠ¶æ€å±•ç¤º

**æ–°å¢è¾“å‡ºæ ¼å¼**:
```
[10:30:05] ğŸš€ ä¼šè¯å·²å¯åŠ¨ (session: 48c10a46...)
[10:30:10] ğŸ“ ç”¨æˆ·: æœç´¢æŸä¸ªä¿¡æ¯
[10:30:12] ğŸ¤– åŠ©æ‰‹: å¼€å§‹æœç´¢...
[10:30:15] ğŸ”§ å·¥å…·è°ƒç”¨: WebSearch (query="æŸä¸ªä¿¡æ¯")
[10:30:18] âœ… å·¥å…·å®Œæˆ: WebSearch (1.2s)
[10:30:25] ğŸ¤– åŠ©æ‰‹: æ‰¾åˆ°ä»¥ä¸‹ç»“æœ...
[10:31:00] âœ¨ ä¼šè¯å®Œæˆ (è€—æ—¶: 55s, å·¥å…·è°ƒç”¨: 3æ¬¡)
```

**æ–°å¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | æè¿° |
|------|------|--------|------|
| `--quiet` | flag | false | é™é»˜æ¨¡å¼ï¼Œä¸æ˜¾ç¤ºçŠ¶æ€è¾“å‡º |
| `--json-status` | flag | false | çŠ¶æ€è¾“å‡ºä½¿ç”¨ JSON æ ¼å¼ |
| `--no-monitor` | flag | false | ç¦ç”¨ä¼šè¯ç›‘æ§ï¼ˆä»…åŸå§‹è¾“å‡ºï¼‰ |

---

### 1.2 æ–°å¢å‘½ä»¤

#### `frago session list`

åˆ—å‡ºæœ€è¿‘çš„ç›‘æ§ä¼šè¯ã€‚

**ç”¨æ³•**:
```bash
frago session list [--limit N] [--agent-type TYPE] [--json]
```

**å‚æ•°**:
| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | æè¿° |
|------|------|--------|------|
| `--limit` | int | 10 | æ˜¾ç¤ºçš„ä¼šè¯æ•°é‡ |
| `--agent-type` | string | all | ç­›é€‰ agent ç±»å‹ |
| `--json` | flag | false | JSON æ ¼å¼è¾“å‡º |

**è¾“å‡ºç¤ºä¾‹ï¼ˆé»˜è®¤ï¼‰**:
```
æœ€è¿‘çš„ä¼šè¯:
  1. [48c10a46] 2025-12-05 10:30 (å®Œæˆ, 55s, 3 å·¥å…·è°ƒç”¨)
     é¡¹ç›®: /home/yammi/repos/Frago
  2. [a1b2c3d4] 2025-12-05 09:15 (å®Œæˆ, 2m30s, 12 å·¥å…·è°ƒç”¨)
     é¡¹ç›®: /home/yammi/repos/ChimeOS
  3. [e5f6g7h8] 2025-12-04 18:00 (é”™è¯¯, 30s, 1 å·¥å…·è°ƒç”¨)
     é¡¹ç›®: /home/yammi/repos/Frago
```

**è¾“å‡ºç¤ºä¾‹ï¼ˆJSONï¼‰**:
```json
{
  "sessions": [
    {
      "session_id": "48c10a46-9f16-4d56-8c65-26de8a5af65c",
      "agent_type": "claude",
      "project_path": "/home/yammi/repos/Frago",
      "started_at": "2025-12-05T10:30:00Z",
      "status": "completed",
      "duration_ms": 55000,
      "tool_call_count": 3
    }
  ]
}
```

---

#### `frago session show <session_id>`

æ˜¾ç¤ºæŒ‡å®šä¼šè¯çš„è¯¦ç»†ä¿¡æ¯ã€‚

**ç”¨æ³•**:
```bash
frago session show <session_id> [--steps] [--tools] [--json]
```

**å‚æ•°**:
| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | æè¿° |
|------|------|--------|------|
| `session_id` | string | å¿…å¡« | ä¼šè¯ IDï¼ˆå¯ç”¨å‰ç¼€åŒ¹é…ï¼‰ |
| `--steps` | flag | false | æ˜¾ç¤ºæ‰€æœ‰æ­¥éª¤ |
| `--tools` | flag | false | æ˜¾ç¤ºå·¥å…·è°ƒç”¨è¯¦æƒ… |
| `--json` | flag | false | JSON æ ¼å¼è¾“å‡º |

**è¾“å‡ºç¤ºä¾‹ï¼ˆé»˜è®¤ï¼‰**:
```
ä¼šè¯è¯¦æƒ…: 48c10a46-9f16-4d56-8c65-26de8a5af65c
  ç±»å‹: claude
  é¡¹ç›®: /home/yammi/repos/Frago
  çŠ¶æ€: å®Œæˆ
  å¼€å§‹: 2025-12-05 10:30:00
  ç»“æŸ: 2025-12-05 10:30:55
  è€—æ—¶: 55 ç§’

ç»Ÿè®¡:
  ç”¨æˆ·æ¶ˆæ¯: 2
  åŠ©æ‰‹æ¶ˆæ¯: 5
  å·¥å…·è°ƒç”¨: 3 (æˆåŠŸ: 3, å¤±è´¥: 0)

ä½¿ç”¨çš„å·¥å…·:
  - WebSearch (1æ¬¡)
  - Read (1æ¬¡)
  - Edit (1æ¬¡)
```

**è¾“å‡ºç¤ºä¾‹ï¼ˆ--stepsï¼‰**:
```
æ­¥éª¤å†å²:
  1. [10:30:05] ç”¨æˆ·æ¶ˆæ¯: æœç´¢æŸä¸ªä¿¡æ¯
  2. [10:30:10] åŠ©æ‰‹æ¶ˆæ¯: æˆ‘æ¥å¸®ä½ æœç´¢...
  3. [10:30:12] å·¥å…·è°ƒç”¨: WebSearch
  4. [10:30:15] å·¥å…·ç»“æœ: WebSearch âœ…
  5. [10:30:20] åŠ©æ‰‹æ¶ˆæ¯: æ‰¾åˆ°ä»¥ä¸‹ç»“æœ...
  ...
```

---

#### `frago session watch [session_id]`

å®æ—¶ç›‘æ§å½“å‰æˆ–æŒ‡å®šä¼šè¯ã€‚

**ç”¨æ³•**:
```bash
frago session watch [session_id] [--json]
```

**å‚æ•°**:
| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | æè¿° |
|------|------|--------|------|
| `session_id` | string | æœ€è¿‘çš„ | ä¼šè¯ IDï¼ˆå¯é€‰ï¼‰ |
| `--json` | flag | false | JSON æ ¼å¼è¾“å‡º |

**è¡Œä¸º**:
- å¦‚æœæœªæŒ‡å®š session_idï¼Œè‡ªåŠ¨ç›‘æ§æœ€è¿‘å¯åŠ¨çš„ä¼šè¯
- å®æ—¶æ˜¾ç¤ºæ–°çš„æ­¥éª¤å’Œå·¥å…·è°ƒç”¨
- æŒ‰ Ctrl+C é€€å‡ºç›‘æ§

**è¾“å‡ºç¤ºä¾‹**:
```
ç›‘æ§ä¼šè¯: 48c10a46... (æŒ‰ Ctrl+C é€€å‡º)
[10:30:05] ğŸš€ ä¼šè¯å·²å¯åŠ¨
[10:30:10] ğŸ“ ç”¨æˆ·: æœç´¢æŸä¸ªä¿¡æ¯
[10:30:12] ğŸ”§ å·¥å…·è°ƒç”¨: WebSearch
  â†’ ç­‰å¾…ä¸­...
[10:30:15] âœ… WebSearch å®Œæˆ (1.2s)
[10:30:20] ğŸ¤– åŠ©æ‰‹: æ‰¾åˆ°ä»¥ä¸‹ç»“æœ...
```

---

#### `frago session clean [--before DATE] [--keep N]`

æ¸…ç†å†å²ä¼šè¯æ•°æ®ã€‚

**ç”¨æ³•**:
```bash
frago session clean [--before DATE] [--keep N] [--dry-run]
```

**å‚æ•°**:
| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | æè¿° |
|------|------|--------|------|
| `--before` | date | æ—  | æ¸…ç†æŒ‡å®šæ—¥æœŸä¹‹å‰çš„ä¼šè¯ |
| `--keep` | int | 100 | ä¿ç•™æœ€è¿‘ N ä¸ªä¼šè¯ |
| `--dry-run` | flag | false | ä»…é¢„è§ˆï¼Œä¸å®é™…åˆ é™¤ |

**è¾“å‡ºç¤ºä¾‹**:
```
å°†åˆ é™¤ 25 ä¸ªä¼šè¯:
  - 48c10a46 (2025-11-01)
  - a1b2c3d4 (2025-11-02)
  ...

ç¡®è®¤åˆ é™¤? [y/N]
```

---

## 2. é€€å‡ºç 

| é€€å‡ºç  | å«ä¹‰ |
|--------|------|
| 0 | æˆåŠŸ |
| 1 | ä¸€èˆ¬é”™è¯¯ |
| 2 | å‚æ•°é”™è¯¯ |
| 3 | ä¼šè¯æœªæ‰¾åˆ° |
| 4 | ç›‘æ§å¤±è´¥ï¼ˆç›®å½•ä¸å­˜åœ¨ã€æƒé™é—®é¢˜ç­‰ï¼‰ |

---

## 3. ç¯å¢ƒå˜é‡

| å˜é‡ | é»˜è®¤å€¼ | æè¿° |
|------|--------|------|
| `FRAGO_SESSION_DIR` | `~/.frago/sessions` | ä¼šè¯æ•°æ®å­˜å‚¨ç›®å½• |
| `FRAGO_CLAUDE_DIR` | `~/.claude` | Claude Code æ•°æ®ç›®å½• |
| `FRAGO_MONITOR_ENABLED` | `1` | æ˜¯å¦å¯ç”¨ä¼šè¯ç›‘æ§ï¼ˆ0 ç¦ç”¨ï¼‰ |
